<configuration>
    <!-- 数据源定义 -->
    <DataSource name="ds1">
        <stream_name>mq2kafka_stream</stream_name>
        <stream_type>kafka</stream_type>
        <class>com.asiainfo.ocdc.streaming.impl.KafkaSource</class>
        <zkQuorum></zkQuorum>
        <topics>com.ailk.flowmanagement.mcd.flux_action</topics>
        <groupId>group</groupId>
        <consumerNum>2</consumerNum>
        <separator>" "</separator>
        <stream_columns>business_id,user_account,business_start_time,content_type,keyword,site_id,activity_code,fee</stream_columns>
    </DataSource>

    <!-- 流数据接入 -->
    <step name="InputStreamStep1" class="com.asiainfo.ocdc.streaming.impl.InputStep">
        <source ref="ds1">
            <output>business_id,user_account,activity_code,fee</output>
        </source>
        <output>business_id,user_account,activity_code,fee</output>
    </step>

    <!-- 动态处理 -->
    <step name="DynamicOperate" type="operate" >
        <HBaseTable>htable</HBaseTable>
        <HBaseKey>user_account</HBaseKey>
        <HBaseCells>fee,fee1,fee2</HBaseCells>
        <expressions>hbase.fee+fee,hbase.fee1+fee1,hbase.fee+hbase.fee2+fee2</expressions>
        <output>business_id,user_account,activity_code,fee</output>
    </step>

</configuration>